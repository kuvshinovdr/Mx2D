# Mx2D
Учебный проект. Моделирование движения тел на плоскости (2D физический движок).

## Части

1. Графика
2. Геометрия
3. Механика
  * Движение твёрдого тела под действием сил (без прямого учёта связей).
  * Возможность задавать поля сил в областях.
  * Учёт трения скольжения (и момента трения качения -- круги?).
  * Удар с коэффициентом восстановления.

## Рассуждения

### Пример "колесо"

1. Колесо массы $m$ и радиуса $r$, момента инерции $J$ движется без отрыва от поверхности и без проскальзывания (три координаты и две связи).
2. Центр масс совпадает с геометрическим центром.
3. К центру масс приложена внешняя активная сила $F$ (если требуется, включает силу веса).
4. К колесу приложен внешний активный момент $M$.

Система:

$$
\left\{\begin{array}{ccc}
m\ddot{x} & = & F_x + R_x,\\
m\ddot{y} & = & F_y + R_y,\\
J\ddot{\varphi} & = & M + R_\varphi,\\
y = r,\\
x = r\varphi.
\end{array}\right.
$$

Силы реакций $R_x$, $R_y$, $R_\varphi$ не известны.

Если продифференцировать уравнения связей, получим дополнительные условия на производные:

$$
\left\{\begin{array}{ccc}
\ddot{y} & = & 0,\\
\ddot{x} & = & r\ddot{\varphi},
\end{array}\right.
$$

из первого получим: $R_y = -F_y$.
Подставив второе в систему, получим:

$$
\left\{\begin{array}{ccc}
m\ddot{x} & = & F_x + R_x,\\
J\ddot{x} & = & r M + r R_\varphi,
\end{array}\right.
$$

т.е. $J(F_x + R_x) = m r(M + R_\varphi)$ или

$$
J R_x + m r R_\varphi = m r M - J F_x,
$$

что пока сохраняет неоднозначность.

Выпишем псевдообращение:

$$
\left\{\begin{array}{ccc}
R_x & = & \dfrac{J}{J^2 + m^2 r^2},\\
R_\varphi & = & \dfrac{m r}{J^2 + m^2 r^2},
\end{array}\right.
$$



q -- вектор состояния системы ("обобщённые переменные")
v -- вектор скоростей
w -- вектор ускорений
R -- вектор неизвестных реакций
Q -- вектор нормированных сил ("обобщённые силы")
A -- функция связей

dq/dt = v ~ q = wh2/2 + v0h + q0
dv/dt = w ~ v = wh + v0
w = Q(t + h/2, (q0 + q)/2, (v0 + v)/2) + R
A(t + h/2, (q0 + q)/2, (v0 + v)/2) = 0
dim A < dim w = dim R => R определяется неоднозначно

A(t, q, dq/dt) = 0
dA/dt = дA/дt(t, q, v) + дA/дq(t, q, v) v + дА/дv(t, q, v) w
